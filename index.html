function openOutlookEmail(normName) {
  const emp = employeeMap[normName];
  if (!emp) return;
  const fullName = emp.original;
  const firstName = fullName.split(' ')[0];
  const over = Object.entries(emp.records)
    .filter(([, r]) => r['Status'] === 'Overdue')
    .map(([topic, r]) => {
      const link = LINKS[topic] || 'Schedule Training';
      const trainDate = r['Training Date'] ? parseTextDate(r['Training Date']) : 'N/A';
      const exp = r['Expiration Date'] ? parseTextDate(r['Expiration Date']) : 'N/A';
      const status = r['Status'] || 'Unknown';
      return `• ${topic}\n  (Training: ${trainDate} | Expires: ${exp})\n  Status: ${status}\n  ${link}`;
    }).join('\n\n');

  const count = over.split('\n').filter(l => l.startsWith('•')).length;
  const body = `Hi ${firstName},

You have ${count} overdue training${count !== 1 ? 's' : ''}:

${over || '• None'}

Please complete ASAP.

Generated: ${new Date().toLocaleString()}
LWA Training Tracker`;

  location.href = `mailto:${RECIPIENT_EMAIL}?subject=Overdue Training: ${encodeURIComponent(fullName)}&body=${encodeURIComponent(body)}`;
}
